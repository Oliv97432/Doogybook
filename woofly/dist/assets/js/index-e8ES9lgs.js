import{u as J,a as X,s as d,j as e}from"./index-CA2N9EnP.js";import{d as Z,r as l}from"./vendor-react-DEK6ZklB.js";import{U as H}from"./UserMenu-soo-JxEI.js";import{U as K}from"./UserMenuPro-Jf9uW8id.js";import{F as Q}from"./Footer-CWwBTAbP.js";import{S as W}from"./SubscriptionBadge-yOA6Z9K7.js";import{Z as P,_ as Y,M as ee,O as se,j as re,$ as te,a0 as T,a1 as E,a2 as M,d as ae,e as A,J as le,X as oe}from"./vendor-ui-DjEwDNDD.js";import"./vendor-supabase-DfwcnzK-.js";const he=()=>{var w,k;const{user:s,signOut:U}=J(),{theme:n,setTheme:R,isPremium:i}=X(),m=Z(),[D,b]=l.useState(!1),[q,j]=l.useState(!0),[x,N]=l.useState("free"),[t,c]=l.useState({full_name:"",email:"",phone:"",location:""}),[v,y]=l.useState(!1),[I,u]=l.useState(!1),[O,f]=l.useState(!1),[h,p]=l.useState("");l.useEffect(()=>{F()},[s]),l.useEffect(()=>{s&&L()},[s]);const F=async()=>{if(s){j(!0);try{const{data:r}=await d.from("professional_accounts").select("id, is_active").eq("user_id",s.id).single();b(r&&r.is_active)}catch{console.log("No pro account found"),b(!1)}finally{j(!1)}}},L=async()=>{var r,o,_,C,S,z;if(s)try{const{data:a,error:g}=await d.from("user_profiles").select("*").eq("id",s.id).single();if(g&&g.code!=="PGRST116")throw g;c({full_name:(a==null?void 0:a.full_name)||((r=s.user_metadata)==null?void 0:r.full_name)||"",email:s.email||"",phone:(a==null?void 0:a.phone)||((o=s.user_metadata)==null?void 0:o.phone)||"",location:(a==null?void 0:a.location)||((_=s.user_metadata)==null?void 0:_.location)||""}),N((a==null?void 0:a.subscription_tier)||"free")}catch(a){console.error("Erreur chargement profil:",a),c({full_name:((C=s.user_metadata)==null?void 0:C.full_name)||"",email:s.email||"",phone:((S=s.user_metadata)==null?void 0:S.phone)||"",location:((z=s.user_metadata)==null?void 0:z.location)||""}),N("free")}},$=async()=>{y(!0),u(!1);try{const{error:r}=await d.auth.updateUser({data:{full_name:t.full_name,phone:t.phone,location:t.location}});if(r)throw r;const{error:o}=await d.from("user_profiles").update({full_name:t.full_name,phone:t.phone,location:t.location,updated_at:new Date().toISOString()}).eq("id",s.id);if(o)throw o;u(!0),setTimeout(()=>u(!1),3e3)}catch(r){console.error("Erreur sauvegarde:",r),alert("‚ùå Erreur lors de la sauvegarde")}finally{y(!1)}},V=async()=>{if(h!==(s==null?void 0:s.email)){alert("‚ö†Ô∏è L'email ne correspond pas");return}if(window.confirm(`‚ö†Ô∏è DERNI√àRE CONFIRMATION

Toutes vos donn√©es seront supprim√©es d√©finitivement.

Continuer ?`))try{const{error:r}=await d.from("dogs").delete().eq("user_id",s.id);if(r)throw r;const{error:o}=await d.from("user_profiles").delete().eq("id",s.id);if(o)throw o;await U(),m("/login"),alert("‚úÖ Votre compte a √©t√© supprim√© avec succ√®s")}catch(r){console.error("Erreur suppression compte:",r),alert("‚ùå Erreur lors de la suppression du compte: "+r.message)}},G=()=>{if(!i){m("/premium");return}R()},B=x==="premium"||x==="professional";return q?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Chargement..."})]})}):e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-card border-b border-border shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 sm:py-4 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>m(-1),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-smooth py-2 min-h-[44px]",children:[e.jsx(P,{size:20}),e.jsx("span",{className:"text-base font-medium",children:"Retour"})]}),D?e.jsx(K,{}):e.jsx(H,{})]})}),e.jsx("main",{className:"flex-1",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-heading font-bold text-foreground",children:"Param√®tres"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"G√©rez votre compte et vos pr√©f√©rences"})]}),I&&e.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded-r-lg mx-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-green-500",children:"‚úì"}),e.jsx("p",{className:"text-green-900 font-medium",children:"Modifications enregistr√©es avec succ√®s !"})]})}),e.jsx("div",{className:"bg-card rounded-xl border border-border p-6 mx-4 shadow-soft",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white text-2xl font-bold flex-shrink-0",children:((w=t.full_name)==null?void 0:w.charAt(0).toUpperCase())||((k=s==null?void 0:s.email)==null?void 0:k.charAt(0).toUpperCase())||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-lg font-heading font-semibold text-foreground truncate",children:t.full_name||"Utilisateur"}),e.jsx("p",{className:"text-sm text-muted-foreground truncate mb-2",children:t.email}),e.jsx(W,{tier:x,size:"sm"})]})]})}),e.jsxs("section",{className:"bg-card rounded-xl border border-border p-6 mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Y,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-heading font-semibold text-foreground",children:"Modifier mon profil"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nom, email, t√©l√©phone, localisation"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Nom complet"}),e.jsx("input",{type:"text",value:t.full_name,onChange:r=>c({...t,full_name:r.target.value}),placeholder:"Votre nom",className:"w-full px-4 py-3 border border-border rounded-lg bg-card text-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Email"}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-muted border border-border rounded-lg",children:[e.jsx(ee,{size:20,className:"text-muted-foreground flex-shrink-0"}),e.jsx("input",{type:"email",value:t.email,readOnly:!0,className:"flex-1 bg-transparent outline-none text-muted-foreground cursor-not-allowed"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"L'email ne peut pas √™tre modifi√© pour des raisons de s√©curit√©"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"T√©l√©phone"}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border border-border rounded-lg bg-card",children:[e.jsx(se,{size:20,className:"text-muted-foreground flex-shrink-0"}),e.jsx("input",{type:"tel",value:t.phone,onChange:r=>c({...t,phone:r.target.value}),placeholder:"06 12 34 56 78",className:"flex-1 bg-transparent text-foreground outline-none focus:ring-0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Localisation"}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border border-border rounded-lg bg-card",children:[e.jsx(re,{size:20,className:"text-muted-foreground flex-shrink-0"}),e.jsx("input",{type:"text",value:t.location,onChange:r=>c({...t,location:r.target.value}),placeholder:"Ville, Pays",className:"flex-1 bg-transparent text-foreground outline-none focus:ring-0"})]})]}),e.jsx("button",{onClick:$,disabled:v,className:"w-full bg-primary text-primary-foreground py-3 rounded-lg font-medium hover:bg-primary/90 transition-smooth flex items-center justify-center gap-2 disabled:opacity-50",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"}),"Enregistrement..."]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{size:20}),"Enregistrer les modifications"]})})]})]}),e.jsxs("section",{className:"bg-card rounded-xl border border-border p-6 mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center flex-shrink-0",children:n==="dark"?e.jsx(T,{className:"text-purple-600",size:24}):e.jsx(E,{className:"text-purple-600",size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-heading font-semibold text-foreground",children:"Apparence"}),i&&e.jsx("span",{className:"px-2 py-0.5 bg-gradient-to-r from-amber-400 to-yellow-500 text-white text-xs font-bold rounded-full",children:"üëë PREMIUM"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i?"Mode sombre disponible":"R√©serv√© aux membres Premium"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${n==="dark"?"bg-gray-800":"bg-gray-100"}`,children:n==="dark"?e.jsx(T,{className:"text-gray-300",size:20}):e.jsx(E,{className:"text-gray-600",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:n==="dark"?"Mode sombre":"Mode clair"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n==="dark"?"Repose tes yeux üåô":"Lumineux et clair ‚òÄÔ∏è"})]})]}),e.jsx("button",{onClick:G,disabled:!i,className:`relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 ${n==="dark"?"bg-purple-600":i?"bg-gray-300":"bg-gray-200"} ${i?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,children:e.jsx("span",{className:`inline-block h-6 w-6 transform rounded-full bg-white transition-transform ${n==="dark"?"translate-x-7":"translate-x-1"}`})})]}),!i&&e.jsx("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-amber-800",children:["üí° ",e.jsx("strong",{children:"Passez √† Premium"})," pour d√©bloquer le mode sombre et bien plus encore !"]})})]}),B?e.jsx("section",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-xl border-2 border-green-200 dark:border-green-700 p-6 mx-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center flex-shrink-0 shadow-md",children:e.jsx(M,{className:"text-white",size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"text-lg font-heading font-semibold text-green-900 dark:text-green-100 flex items-center gap-2",children:["Compte Premium actif",e.jsx(ae,{size:20,className:"text-green-600 dark:text-green-400"})]}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300 font-medium",children:"Chiens illimit√©s ‚Ä¢ Photos illimit√©es ‚Ä¢ Recettes personnalis√©es"})]})]})}):e.jsx("section",{onClick:()=>m("/premium"),className:"bg-gradient-to-br from-amber-50 to-yellow-50 dark:from-amber-900/20 dark:to-yellow-900/20 rounded-xl border-2 border-amber-200 dark:border-amber-700 p-6 mx-4 cursor-pointer hover:shadow-lg transition-all duration-200 hover:scale-[1.02]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-amber-400 to-yellow-500 flex items-center justify-center flex-shrink-0 shadow-md",children:e.jsx(M,{className:"text-white",size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-heading font-semibold text-amber-900 dark:text-amber-100 flex items-center gap-2",children:"Passer √† Premium"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300 font-medium",children:"Chiens et photos illimit√©s ‚Ä¢ 3,99‚Ç¨/mois"})]})]}),e.jsx(P,{size:24,className:"text-amber-600 dark:text-amber-400 flex-shrink-0 rotate-180"})]})}),e.jsxs("section",{className:"bg-card rounded-xl border border-red-200 dark:border-red-800 p-6 mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-red-500 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(A,{className:"text-white",size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-heading font-semibold text-red-900 dark:text-red-100",children:"Supprimer mon compte"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:"Action irr√©versible - Toutes vos donn√©es seront perdues"})]})]}),e.jsxs("button",{onClick:()=>f(!0),className:"w-full bg-red-600 text-white py-3 rounded-lg font-medium hover:bg-red-700 transition-smooth flex items-center justify-center gap-2",children:[e.jsx(le,{size:20}),"Supprimer mon compte"]})]}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground px-4",children:[e.jsx("p",{children:"Doogybook v1.0.0"}),e.jsx("p",{className:"mt-1",children:"¬© 2025 Doogybook. Tous droits r√©serv√©s."})]})]})}),O&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:e.jsxs("div",{className:"bg-card rounded-xl shadow-xl max-w-md w-full p-6 mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-heading font-bold text-foreground",children:"Supprimer mon compte"}),e.jsx("button",{onClick:()=>{f(!1),p("")},className:"p-2 hover:bg-muted rounded-full",children:e.jsx(oe,{size:20})})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:[e.jsxs("h4",{className:"font-semibold text-red-900 dark:text-red-100 mb-2 flex items-center gap-2",children:[e.jsx(A,{size:20,className:"text-red-900 dark:text-red-100"}),"Donn√©es qui seront supprim√©es :"]}),e.jsxs("ul",{className:"text-sm text-red-800 dark:text-red-200 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Tous vos chiens et leurs profils"}),e.jsx("li",{children:"‚Ä¢ Toutes les photos"}),e.jsx("li",{children:"‚Ä¢ Toutes les vaccinations et traitements"}),e.jsx("li",{children:"‚Ä¢ Toutes les notes m√©dicales"}),e.jsx("li",{children:"‚Ä¢ Votre compte utilisateur"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Confirmez votre email pour continuer :"}),e.jsx("input",{type:"email",value:h,onChange:r=>p(r.target.value),placeholder:s==null?void 0:s.email,className:"w-full px-4 py-3 border border-border rounded-lg bg-card text-foreground focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>{f(!1),p("")},className:"px-4 py-3 border border-border rounded-lg hover:bg-muted transition-smooth",children:"Annuler"}),e.jsx("button",{onClick:V,disabled:h!==(s==null?void 0:s.email),className:"px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-smooth",children:"Supprimer d√©finitivement"})]})]})}),e.jsx(Q,{})]})};export{he as default};
