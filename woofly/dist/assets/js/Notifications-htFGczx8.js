import{j as e}from"./index-CA2N9EnP.js";import{d as w}from"./vendor-react-DEK6ZklB.js";import{u as y}from"./useNotifications-BySDGNmr.js";import{T as k}from"./TabNavigation-DfIL662q.js";import{F as _}from"./Footer-CWwBTAbP.js";import{n as A,d as $,H as u,v as C,x as z}from"./vendor-ui-DjEwDNDD.js";import"./vendor-supabase-DfwcnzK-.js";const q=()=>{const c=w(),{notifications:i,unreadCount:x,loading:f,markAsRead:h,markAllAsRead:p}=y(),b=s=>{switch(s){case"like":return e.jsx(u,{className:"text-red-500",size:20});case"comment":return e.jsx(z,{className:"text-blue-500",size:20});case"follow":return e.jsx(C,{className:"text-green-500",size:20});default:return null}},g=s=>{var a,r,l,o;const t=((r=(a=s.actor)==null?void 0:a.user_profiles)==null?void 0:r.full_name)||((o=(l=s.actor)==null?void 0:l.email)==null?void 0:o.split("@")[0])||"Quelqu'un";switch(s.type){case"like":return`${t} a aimé votre post`;case"comment":return`${t} a commenté votre post`;case"follow":return`${t} vous suit maintenant`;default:return"Nouvelle notification"}},j=async s=>{s.is_read||await h(s.id),s.type==="follow"?c(`/profile/${s.actor_id}`):s.post_id&&c(`/social-feed?post=${s.post_id}`)},N=s=>{const t=new Date(s),r=new Date-t,l=Math.floor(r/6e4),o=Math.floor(r/36e5),n=Math.floor(r/864e5);return l<60?`Il y a ${l} min`:o<24?`Il y a ${o}h`:n<7?`Il y a ${n}j`:t.toLocaleDateString("fr-FR")},v=s=>{var a,r;const t=(r=(a=s.actor)==null?void 0:a.user_profiles)==null?void 0:r.avatar_url;return t?t.startsWith("http")?t:supabase.storage.from("user-avatars").getPublicUrl(t).data.publicUrl:null};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-card border-b border-border shadow-soft",children:e.jsx("div",{className:"max-w-screen-xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>c(-1),className:"p-2 hover:bg-muted rounded-full transition-smooth",children:e.jsx(A,{size:20})}),e.jsx("h1",{className:"text-2xl font-heading font-semibold text-foreground",children:"Notifications"})]}),x>0&&e.jsxs("button",{onClick:p,className:"flex items-center gap-2 text-blue-500 hover:text-blue-600 font-medium text-sm",children:[e.jsx($,{size:16}),"Tout marquer lu"]})]})})}),e.jsx(k,{}),e.jsx("main",{className:"main-content flex-1",children:e.jsx("div",{className:"max-w-3xl mx-auto px-4 py-6",children:f?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-blue-500 border-t-transparent rounded-full"})}):i.length>0?e.jsx("div",{className:"space-y-2",children:i.map(s=>{var r,l,o,n,m,d;const t=((l=(r=s.actor)==null?void 0:r.user_profiles)==null?void 0:l.full_name)||((n=(o=s.actor)==null?void 0:o.email)==null?void 0:n.split("@")[0])||"Utilisateur",a=v(s);return e.jsxs("button",{onClick:()=>j(s),className:`w-full flex items-start gap-3 p-4 rounded-xl transition-smooth text-left ${s.is_read?"bg-white hover:bg-gray-50":"bg-blue-50 hover:bg-blue-100 border-l-4 border-blue-500"}`,children:[e.jsxs("div",{className:"flex-shrink-0",children:[a?e.jsx("img",{src:a,alt:t,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold",children:t.charAt(0).toUpperCase()}),e.jsx("div",{className:"absolute -mt-3 -ml-2 bg-white rounded-full p-1 shadow-md",children:b(s.type)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-base text-gray-900 font-medium",children:g(s)}),((m=s.post)==null?void 0:m.content)&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:['"',s.post.content,'"']}),((d=s.comment)==null?void 0:d.content)&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:['"',s.comment.content,'"']}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:N(s.created_at)})]}),!s.is_read&&e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]},s.id)})}):e.jsxs("div",{className:"bg-white rounded-3xl p-12 text-center border border-gray-200",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(u,{className:"text-gray-400",size:32})}),e.jsx("h3",{className:"text-xl font-heading font-semibold text-gray-900 mb-2",children:"Aucune notification"}),e.jsx("p",{className:"text-gray-600",children:"Vos notifications apparaîtront ici"})]})})}),e.jsx(_,{})]})};export{q as default};
