import{u as C,s as o,j as e}from"./index-PRF-HlSu.js";import{d as z,r as n}from"./vendor-react-DEK6ZklB.js";import{U as b}from"./UserMenuPro-Dq68DPXh.js";import{n as f,_ as S,M as j,O as E,j as R,X as D,d as P}from"./vendor-ui-DjEwDNDD.js";import"./vendor-supabase-DfwcnzK-.js";const F=()=>{var u;const{user:i}=C(),c=z(),[y,N]=n.useState(!0),[w,v]=n.useState(null),[k,_]=n.useState([]),[l,x]=n.useState("pending"),[s,d]=n.useState(null);n.useEffect(()=>{i&&A()},[i]);const A=async()=>{try{const{data:t,error:r}=await o.from("professional_accounts").select("*").eq("user_id",i.id).single();if(r)throw r;v(t),h(t.id)}catch(t){console.error("Erreur:",t),c("/pro/register")}},h=async t=>{try{const{data:r,error:a}=await o.from("adoption_applications").select(`
          *,
          dog:dogs(*)
        `).eq("professional_account_id",t).order("created_at",{ascending:!1});if(a)throw a;_(r||[])}catch(r){console.error("Erreur chargement candidatures:",r)}finally{N(!1)}},m=async(t,r)=>{try{const{error:a}=await o.from("adoption_applications").update({status:r,reviewed_at:new Date().toISOString(),reviewed_by:i.id}).eq("id",t);if(a)throw a;await h(w.id),d(null)}catch(a){console.error("Erreur mise à jour statut:",a),alert("Erreur lors de la mise à jour")}},p=k.filter(t=>l==="all"?!0:t.status===l),g=t=>{const r={pending:{bg:"bg-orange-100",text:"text-orange-800",label:"En attente"},approved:{bg:"bg-green-100",text:"text-green-800",label:"Approuvée"},rejected:{bg:"bg-red-100",text:"text-red-800",label:"Refusée"},withdrawn:{bg:"bg-gray-100",text:"text-gray-800",label:"Retirée"}},a=r[t]||r.pending;return e.jsx("span",{className:`px-3 py-1 ${a.bg} ${a.text} text-xs font-bold rounded-full whitespace-nowrap`,children:a.label})};return y?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-blue-500 border-t-transparent rounded-full"})}):s?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>d(null),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 min-h-[44px] min-w-[44px]","aria-label":"Retour à la liste",children:[e.jsx(f,{size:20}),e.jsx("span",{className:"font-medium hidden xs:inline",children:"Retour"})]}),e.jsx("h1",{className:"text-lg sm:text-xl font-heading font-bold text-gray-900 truncate px-2",children:"Candidature"}),e.jsxs("div",{className:"flex items-center gap-2",children:[" ",g(s.status),e.jsx(b,{})," "]})]})}),e.jsxs("main",{className:"max-w-4xl mx-auto px-3 sm:px-4 py-6 sm:py-8",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl sm:rounded-3xl p-4 sm:p-6 text-white mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[s.dog.photo_url?e.jsx("img",{src:s.dog.photo_url,alt:s.dog.name,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-lg sm:rounded-xl object-cover flex-shrink-0"}):e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-white/20 rounded-lg sm:rounded-xl flex items-center justify-center text-2xl sm:text-3xl font-bold",children:(u=s.dog.name)==null?void 0:u.charAt(0)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-heading font-bold truncate",children:s.dog.name}),e.jsx("p",{className:"text-white/90 truncate",children:s.dog.breed})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl p-5 sm:p-8 shadow-sm mb-4 sm:mb-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-heading font-bold text-gray-900 mb-4 sm:mb-6",children:"Informations du candidat"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(S,{size:18,className:"text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nom complet"}),e.jsx("p",{className:"font-semibold text-gray-900 break-words",children:s.full_name})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(j,{size:18,className:"text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-semibold text-gray-900 break-all",children:s.email})]})]}),s.phone&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{size:18,className:"text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Téléphone"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.phone})]})]}),(s.address||s.city)&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{size:18,className:"text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Adresse"}),e.jsxs("p",{className:"font-semibold text-gray-900 break-words",children:[s.address,s.city&&`, ${s.city}`,s.postal_code&&` ${s.postal_code}`]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl p-5 sm:p-8 shadow-sm mb-4 sm:mb-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-heading font-bold text-gray-900 mb-4 sm:mb-6",children:"Situation"}),e.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 sm:p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Jardin"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.has_garden?"✅ Oui":"❌ Non"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 sm:p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Autres animaux"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.has_other_pets?"✅ Oui":"❌ Non"})]})]}),s.other_pets_details&&e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Détails animaux"}),e.jsx("p",{className:"text-gray-900 break-words",children:s.other_pets_details})]}),s.family_composition&&e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Composition du foyer"}),e.jsx("p",{className:"text-gray-900 break-words",children:s.family_composition})]}),s.experience_with_dogs&&e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Expérience avec les chiens"}),e.jsx("p",{className:"text-gray-900 break-words",children:s.experience_with_dogs})]}),s.availability&&e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Disponibilité"}),e.jsx("p",{className:"text-gray-900 break-words",children:s.availability})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl p-5 sm:p-8 shadow-sm mb-4 sm:mb-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-heading font-bold text-gray-900 mb-3 sm:mb-4",children:"Motivation"}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto pr-2",children:e.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap break-words",children:s.motivation})})]}),s.status==="pending"&&e.jsxs("div",{className:"flex flex-col xs:flex-row gap-3 sm:gap-4",children:[e.jsxs("button",{onClick:()=>m(s.id,"rejected"),className:"flex-1 py-3 sm:py-4 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 flex items-center justify-center gap-2 min-h-[52px]",children:[e.jsx(D,{size:18,className:"sm:size-5"}),e.jsx("span",{children:"Refuser"})]}),e.jsxs("button",{onClick:()=>m(s.id,"approved"),className:"flex-1 py-3 sm:py-4 bg-green-500 text-white rounded-xl font-bold hover:bg-green-600 flex items-center justify-center gap-2 min-h-[52px]",children:[e.jsx(P,{size:18,className:"sm:size-5"}),e.jsx("span",{children:"Approuver"})]})]}),s.status!=="pending"&&e.jsx("div",{className:"bg-gray-50 rounded-xl p-3 sm:p-4 text-center",children:e.jsxs("p",{className:"text-gray-600 text-sm sm:text-base",children:["Candidature ",s.status==="approved"?"approuvée":"refusée"," le"," ",new Date(s.reviewed_at).toLocaleDateString("fr-FR")]})})]})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-3 sm:py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[e.jsxs("button",{onClick:()=>c("/pro/dashboard"),className:"flex items-center gap-1 sm:gap-2 text-gray-600 hover:text-gray-900 min-h-[44px] min-w-[44px]","aria-label":"Retour au tableau de bord",children:[e.jsx(f,{size:18,className:"sm:size-5"}),e.jsx("span",{className:"font-medium text-sm sm:text-base hidden xs:inline",children:"Dashboard"})]}),e.jsx("h1",{className:"text-lg sm:text-xl font-heading font-bold text-gray-900 truncate px-2",children:"Candidatures"}),e.jsx(b,{})," "]}),e.jsx("div",{className:"overflow-x-auto pb-2 -mx-3 sm:mx-0 px-3 sm:px-0",children:e.jsxs("div",{className:"flex gap-1 sm:gap-2 min-w-max",children:[e.jsx("button",{onClick:()=>x("all"),className:`px-3 sm:px-4 py-2 rounded-xl font-medium text-sm sm:text-base transition-smooth whitespace-nowrap min-h-[44px] ${l==="all"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Toutes"}),e.jsx("button",{onClick:()=>x("pending"),className:`px-3 sm:px-4 py-2 rounded-xl font-medium text-sm sm:text-base transition-smooth whitespace-nowrap min-h-[44px] ${l==="pending"?"bg-orange-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"En attente"}),e.jsx("button",{onClick:()=>x("approved"),className:`px-3 sm:px-4 py-2 rounded-xl font-medium text-sm sm:text-base transition-smooth whitespace-nowrap min-h-[44px] ${l==="approved"?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Approuvées"}),e.jsx("button",{onClick:()=>x("rejected"),className:`px-3 sm:px-4 py-2 rounded-xl font-medium text-sm sm:text-base transition-smooth whitespace-nowrap min-h-[44px] ${l==="rejected"?"bg-red-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Refusées"})]})})]})}),e.jsx("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-4 sm:py-6",children:p.length===0?e.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl p-6 sm:p-12 text-center",children:[e.jsx(j,{size:40,className:"sm:size-12 text-gray-300 mx-auto mb-3 sm:mb-4"}),e.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Aucune candidature pour le moment"})]}):e.jsx("div",{className:"space-y-3 sm:space-y-4",children:p.map(t=>{var r;return e.jsx("div",{onClick:()=>d(t),className:"bg-white rounded-2xl sm:rounded-3xl p-4 sm:p-6 shadow-sm border border-gray-200 hover:shadow-lg transition-all cursor-pointer active:scale-[0.99]",children:e.jsxs("div",{className:"flex flex-col xs:flex-row items-start xs:items-center gap-3 sm:gap-4",children:[t.dog.photo_url?e.jsx("img",{src:t.dog.photo_url,alt:t.dog.name,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-xl object-cover flex-shrink-0 mx-auto xs:mx-0"}):e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-blue-400 to-purple-500 rounded-xl flex items-center justify-center text-white text-xl sm:text-2xl font-bold flex-shrink-0 mx-auto xs:mx-0",children:(r=t.dog.name)==null?void 0:r.charAt(0)}),e.jsxs("div",{className:"flex-1 min-w-0 text-center xs:text-left",children:[e.jsxs("div",{className:"flex flex-col xs:flex-row xs:items-center gap-2 xs:gap-3 mb-2",children:[e.jsx("h3",{className:"font-bold text-base sm:text-lg text-gray-900 truncate",children:t.full_name}),e.jsx("div",{className:"flex justify-center xs:justify-start",children:g(t.status)})]}),e.jsxs("p",{className:"text-gray-600 text-sm sm:text-base mb-2 break-words",children:["Souhaite adopter ",e.jsx("strong",{children:t.dog.name})]}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500",children:["Candidature envoyée le ",new Date(t.created_at).toLocaleDateString("fr-FR")]})]}),t.status==="pending"&&e.jsxs("div",{className:"flex gap-2 flex-shrink-0 w-full xs:w-auto justify-center xs:justify-start mt-2 xs:mt-0",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),m(t.id,"rejected")},className:"px-3 sm:px-4 py-2 bg-red-100 text-red-600 rounded-xl hover:bg-red-200 font-medium text-sm sm:text-base min-h-[44px] flex-1 xs:flex-none",children:"Refuser"}),e.jsx("button",{onClick:a=>{a.stopPropagation(),m(t.id,"approved")},className:"px-3 sm:px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 font-medium text-sm sm:text-base min-h-[44px] flex-1 xs:flex-none",children:"Approuver"})]})]})},t.id)})})})]})};export{F as default};
