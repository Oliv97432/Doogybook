import{j as t,I as h,u as ge,s as d}from"./index-DErj2e1l.js";import{d as ne,r as l}from"./vendor-react-DEK6ZklB.js";import{T as se}from"./TabNavigation-BZai1hZX.js";import{U as fe}from"./UserMenu-BKFNKqW7.js";import{B as y}from"./Button-BqLp_x3i.js";import{V as ve,T as re,W as be,H as we,A as je,a as ie,b as Ne,E as ye,P as _e}from"./PhotoGalleryModal-CO93QUj7.js";import{F as Se}from"./Footer-xc1HNBWs.js";import{P as De}from"./PremiumModal-DgBupXIV.js";import{E as Ce}from"./jspdf.es.min-O7t-lC5C.js";import"./vendor-ui-DyJst9CI.js";import"./vendor-supabase-DfwcnzK-.js";import"./PremiumBadge-bvXuw7BL.js";import"./index-1Ar5VAb3.js";import"./Input-Ci-7L08s.js";const Fe=()=>{const c=ne(),p=[{icon:"Syringe",title:"Carnet de santÃ© complet",description:"Suivez vaccins, vermifuges et traitements anti-puces en un clin d'oeil",gradient:"from-blue-500 to-cyan-500"},{icon:"TrendingUp",title:"Suivi du poids",description:"Graphiques d'Ã©volution pour surveiller la santÃ© de votre compagnon",gradient:"from-purple-500 to-pink-500"},{icon:"Bell",title:"Rappels automatiques",description:"Ne manquez jamais un rendez-vous vÃ©tÃ©rinaire ou un traitement",gradient:"from-orange-500 to-red-500"},{icon:"Camera",title:"Album photos",description:"CrÃ©ez des souvenirs inoubliables avec votre chien",gradient:"from-green-500 to-emerald-500"},{icon:"Users",title:"CommunautÃ© active",description:"Partagez et Ã©changez avec d'autres propriÃ©taires de chiens",gradient:"from-indigo-500 to-purple-500"},{icon:"FileText",title:"Export PDF",description:"Exportez le carnet de santÃ© complet pour vos visites vÃ©tÃ©rinaires",gradient:"from-teal-500 to-cyan-500"}],S=[{value:"10,000+",label:"Chiens enregistrÃ©s"},{value:"50,000+",label:"Vaccins suivis"},{value:"98%",label:"Satisfaction"}];return t.jsxs("div",{className:"min-h-[calc(100vh-73px)] bg-gradient-to-b from-blue-50 via-purple-50/30 to-white",children:[t.jsxs("section",{className:"container mx-auto px-4 pt-8 sm:pt-12 pb-8 text-center",children:[t.jsx("div",{className:"mb-6 flex justify-center",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400 to-purple-400 rounded-full blur-2xl opacity-20 animate-pulse"}),t.jsx("div",{className:"relative bg-gradient-to-br from-blue-500 to-purple-600 rounded-full p-8 shadow-2xl",children:t.jsx(h,{name:"Dog",size:64,color:"white",strokeWidth:2})}),t.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg",children:"Gratuit"}),t.jsx("div",{className:"absolute -bottom-2 -left-2 bg-blue-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg",children:"100% SÃ©curisÃ©"})]})}),t.jsxs("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-heading font-bold text-gray-900 mb-4 leading-tight",children:["Bienvenue sur ",t.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"DoogyBook"})," !"]}),t.jsx("p",{className:"text-base sm:text-lg lg:text-xl text-gray-600 max-w-2xl mx-auto mb-8 leading-relaxed",children:"Le carnet de santÃ© digital qui simplifie le suivi mÃ©dical de votre compagnon Ã  quatre pattes"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center items-center mb-6",children:[t.jsx(y,{size:"lg",className:"px-8 shadow-lg hover:shadow-xl transition-all bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 min-h-[48px] text-base font-semibold",onClick:()=>c("/multi-profile-management"),iconName:"Plus",children:"CrÃ©er le profil de mon chien"}),t.jsx(y,{size:"lg",variant:"outline",className:"px-8 min-h-[48px] text-base border-2",onClick:()=>c("/social-feed"),iconName:"Users",children:"DÃ©couvrir la communautÃ©"})]}),t.jsx("p",{className:"text-sm text-gray-500",children:"Sans engagement â€¢ Sans carte bancaire â€¢ Sans publicitÃ©"})]}),t.jsx("section",{className:"container mx-auto px-4 py-6",children:t.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-w-3xl mx-auto",children:t.jsx("div",{className:"grid grid-cols-3 gap-4 divide-x divide-gray-200",children:S.map((x,_)=>t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:x.value}),t.jsx("div",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:x.label})]},_))})})}),t.jsxs("section",{className:"container mx-auto px-4 py-8 sm:py-12",children:[t.jsx("h2",{className:"text-2xl sm:text-3xl font-heading font-bold text-center text-gray-900 mb-3",children:"Tout ce dont vous avez besoin"}),t.jsx("p",{className:"text-center text-gray-600 mb-8 max-w-2xl mx-auto",children:"Une suite complÃ¨te d'outils pour prendre soin de la santÃ© de votre chien"}),t.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 max-w-6xl mx-auto",children:p.map((x,_)=>t.jsxs("div",{className:"group bg-white rounded-xl shadow-md hover:shadow-xl transition-all duration-300 p-6 border border-gray-100 hover:border-transparent hover:-translate-y-1",children:[t.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${x.gradient} rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300`,children:t.jsx(h,{name:x.icon,size:28,color:"white",strokeWidth:2})}),t.jsx("h3",{className:"font-heading font-semibold text-gray-900 mb-2 text-lg",children:x.title}),t.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:x.description})]},_))})]}),t.jsx("section",{className:"container mx-auto px-4 py-12 pb-16",children:t.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl shadow-2xl p-8 sm:p-12 text-center text-white max-w-4xl mx-auto",children:[t.jsx("h2",{className:"text-2xl sm:text-3xl font-heading font-bold mb-4",children:"PrÃªt Ã  commencer ?"}),t.jsx("p",{className:"text-blue-100 text-lg mb-6 max-w-2xl mx-auto",children:"Rejoignez des milliers de propriÃ©taires qui font dÃ©jÃ  confiance Ã  DoogyBook"}),t.jsx(y,{size:"xl",className:"bg-white text-blue-600 hover:bg-gray-100 shadow-xl hover:shadow-2xl transition-all font-semibold px-10",onClick:()=>c("/multi-profile-management"),iconName:"Sparkles",children:"Commencer gratuitement"}),t.jsxs("div",{className:"flex items-center justify-center gap-3 mt-8",children:[t.jsx("div",{className:"flex -space-x-3",children:[1,2,3,4].map(x=>t.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-400 border-2 border-white flex items-center justify-center",children:t.jsx(h,{name:"Dog",size:20,color:"white"})},x))}),t.jsxs("p",{className:"text-sm text-blue-100",children:[t.jsx("strong",{className:"text-white",children:"10 000+"})," propriÃ©taires nous font confiance"]})]})]})})]})},Ee=(c,p=800,S=75)=>{if(!c)return null;if(c.includes("supabase.co")&&c.includes("storage/v1/object/public")){const x=c.includes("?")?"&":"?";return`${c}${x}width=${p}&quality=${S}&format=webp`}return c},U=l.memo(({src:c,alt:p,width:S=800,quality:x=75,className:_="",eager:k=!1})=>{const[A,O]=l.useState(!1),[E,D]=l.useState(!1);return t.jsxs("div",{className:"relative w-full h-full",children:[!A&&!E&&t.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"}),E?t.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-100 to-purple-100",children:t.jsx("span",{className:"text-4xl font-bold text-primary/30",children:p==null?void 0:p.charAt(0).toUpperCase()})}):t.jsx("img",{src:Ee(c,S,x),alt:p,loading:k?"eager":"lazy",decoding:"async",onLoad:()=>O(!0),onError:()=>D(!0),className:`${_} ${A?"opacity-100":"opacity-0"} transition-opacity duration-300`})]})});U.displayName="OptimizedImage";const Be=()=>{ne();const{user:c}=ge(),[p,S]=l.useState("vaccinations"),[x,_]=l.useState(!0),[k,A]=l.useState(!1),[O,E]=l.useState(!1),[D,q]=l.useState(!1),[Te,$]=l.useState([]),[i,T]=l.useState(null),[z,I]=l.useState([]),[P,L]=l.useState([]),[C,R]=l.useState([]),[v,V]=l.useState({allergies:"",medications:"",veterinaryNotes:"",veterinarian:"",veterinarianPhone:""}),[oe,W]=l.useState([]),[B,G]=l.useState(!1),[F,H]=l.useState({vaccination:!1,vermifuge:!1,flea:!1,weight:!1,editProfile:!1,gallery:!1}),[w,Y]=l.useState(null);l.useEffect(()=>{(async()=>{if(c!=null&&c.id)try{const{data:s}=await d.from("user_profiles").select("subscription_tier").eq("id",c.id).single();A(["premium","professional"].includes(s==null?void 0:s.subscription_tier))}catch(s){console.error("Erreur vÃ©rification premium:",s)}})()},[c==null?void 0:c.id]),l.useEffect(()=>{if(!(c!=null&&c.id))return;(async()=>{_(!0);try{const{data:s,error:n}=await d.from("dogs").select("id, name, breed, birth_date, weight, gender, is_sterilized, photo_url, microchip_number, notes, cover_photo_url").eq("user_id",c.id).eq("is_active",!0).order("created_at",{ascending:!1}).limit(10);if(n)throw n;const r=s.map(a=>{const o=new Date(a.birth_date),m=new Date;let b=m.getFullYear()-o.getFullYear();const N=m.getMonth()-o.getMonth();return(N<0||N===0&&m.getDate()<o.getDate())&&b--,{id:a.id,name:a.name,breed:a.breed||"Race inconnue",age:b>0?`${b} an${b>1?"s":""}`:"Moins d'un an",weight:a.weight?`${a.weight} kg`:"Non renseignÃ©",gender:a.gender||"Non renseignÃ©",sterilized:a.is_sterilized?"StÃ©rilisÃ©":"Non stÃ©rilisÃ©",image:a.photo_url||"https://images.pexels.com/photos/1490908/pexels-photo-1490908.jpeg",imageAlt:`${a.name} - ${a.breed}`,microchip_number:a.microchip_number,notes:a.notes,cover_photo_url:a.cover_photo_url||null,birth_date:a.birth_date}});$(r),r.length>0&&T(r[0])}catch(s){console.error("Erreur chargement chiens:",s)}finally{_(!1)}})()},[c==null?void 0:c.id]),l.useEffect(()=>{if(!(i!=null&&i.id))return;(async()=>{try{const{data:s,error:n}=await d.from("vaccinations").select("id, vaccine_name, vaccination_date, next_due_date, veterinarian, notes").eq("dog_id",i.id).order("next_due_date",{ascending:!0}).limit(50);if(n)throw n;const r=s.map(a=>({id:a.id,name:a.vaccine_name,lastDate:new Date(a.vaccination_date).toLocaleDateString("fr-FR"),nextDate:a.next_due_date?new Date(a.next_due_date).toLocaleDateString("fr-FR"):"Non dÃ©fini",veterinarian:a.veterinarian,notes:a.notes}));I(r)}catch(s){console.error("Erreur chargement vaccinations:",s)}})()},[i==null?void 0:i.id]),l.useEffect(()=>{if(!(i!=null&&i.id))return;(async()=>{try{const{data:s,error:n}=await d.from("treatments").select("id, product_name, treatment_date, next_due_date, notes, treatment_type").eq("dog_id",i.id).order("next_due_date",{ascending:!0}).limit(50);if(n)throw n;const r=s.map(a=>({id:a.id,product:a.product_name,lastDate:new Date(a.treatment_date).toLocaleDateString("fr-FR"),nextDate:a.next_due_date?new Date(a.next_due_date).toLocaleDateString("fr-FR"):"Non dÃ©fini",notes:a.notes,type:a.treatment_type}));L(r)}catch(s){console.error("Erreur chargement traitements:",s)}})()},[i==null?void 0:i.id]),l.useEffect(()=>{if(!(i!=null&&i.id))return;(async()=>{try{const{data:s,error:n}=await d.from("weight_records").select("measurement_date, weight").eq("dog_id",i.id).order("measurement_date",{ascending:!0}).limit(100);if(n)throw n;const r=s.map(a=>({date:new Date(a.measurement_date).toLocaleDateString("fr-FR"),weight:parseFloat(a.weight)}));R(r)}catch(s){console.error("Erreur chargement poids:",s)}})()},[i==null?void 0:i.id]),l.useEffect(()=>{if(!(i!=null&&i.id))return;(async()=>{var s,n,r;try{const{data:a,error:o}=await d.from("health_notes").select("description, tags, title").eq("dog_id",i.id).order("note_date",{ascending:!1}).limit(1);if(o)throw o;if(a&&a.length>0){const m=a[0];V({allergies:(s=m.tags)!=null&&s.includes("allergies")?m.description:"",medications:(n=m.tags)!=null&&n.includes("medications")?m.description:"",veterinaryNotes:m.description||"",veterinarian:(r=m.tags)!=null&&r.includes("vet")?m.title:"",veterinarianPhone:""})}}catch(a){console.error("Erreur chargement notes santÃ©:",a)}})()},[i==null?void 0:i.id]),l.useEffect(()=>{if(!(i!=null&&i.id))return;(async()=>{try{const{data:s,error:n}=await d.from("dog_photos").select("id, photo_url, created_at").eq("dog_id",i.id).order("created_at",{ascending:!1}).limit(50);if(n)throw n;W(s||[])}catch(s){console.error("Erreur chargement photos:",s)}})()},[i==null?void 0:i.id]);const j=l.useCallback((e,s=null)=>{Y(s),H(n=>({...n,[e]:!0}))},[]),f=l.useCallback(e=>{H(s=>({...s,[e]:!1})),Y(null)},[]),le=l.useCallback(async e=>{try{if(w){const{error:s}=await d.from("vaccinations").update({vaccine_name:e.name,vaccination_date:new Date(e.lastDate).toISOString().split("T")[0],next_due_date:e.nextDate?new Date(e.nextDate).toISOString().split("T")[0]:null,veterinarian:e.veterinarian,notes:e.notes}).eq("id",w.id);if(s)throw s;I(n=>n.map(r=>r.id===w.id?{...e,id:r.id}:r))}else{const{data:s,error:n}=await d.from("vaccinations").insert([{dog_id:i.id,vaccine_name:e.name,vaccination_date:new Date(e.lastDate).toISOString().split("T")[0],next_due_date:e.nextDate?new Date(e.nextDate).toISOString().split("T")[0]:null,veterinarian:e.veterinarian,notes:e.notes}]).select().single();if(n)throw n;I(r=>[...r,{id:s.id,name:e.name,lastDate:new Date(e.lastDate).toLocaleDateString("fr-FR"),nextDate:e.nextDate?new Date(e.nextDate).toLocaleDateString("fr-FR"):"Non dÃ©fini",veterinarian:e.veterinarian,notes:e.notes}])}f("vaccination")}catch(s){console.error("Erreur sauvegarde vaccination:",s),alert("Erreur lors de la sauvegarde de la vaccination")}},[w,i,f]),ce=l.useCallback(async e=>{if(window.confirm("ÃŠtes-vous sÃ»r de vouloir supprimer cette vaccination ?"))try{const{error:s}=await d.from("vaccinations").delete().eq("id",e);if(s)throw s;I(n=>n.filter(r=>r.id!==e))}catch(s){console.error("Erreur suppression vaccination:",s),alert("Erreur lors de la suppression")}},[]),J=l.useCallback(async(e,s)=>{try{const n=s==="vermifuge"?"worm":"flea";if(w){const{error:r}=await d.from("treatments").update({product_name:e.product,treatment_date:new Date(e.lastDate).toISOString().split("T")[0],next_due_date:e.nextDate?new Date(e.nextDate).toISOString().split("T")[0]:null,notes:e.notes,treatment_type:n}).eq("id",w.id);if(r)throw r;L(a=>a.map(o=>o.id===w.id?{...e,id:o.id,type:n}:o))}else{const{data:r,error:a}=await d.from("treatments").insert([{dog_id:i.id,product_name:e.product,treatment_date:new Date(e.lastDate).toISOString().split("T")[0],next_due_date:e.nextDate?new Date(e.nextDate).toISOString().split("T")[0]:null,notes:e.notes,treatment_type:n}]).select().single();if(a)throw a;L(o=>[...o,{id:r.id,product:e.product,lastDate:new Date(e.lastDate).toLocaleDateString("fr-FR"),nextDate:e.nextDate?new Date(e.nextDate).toLocaleDateString("fr-FR"):"Non dÃ©fini",notes:e.notes,type:n}])}f(s)}catch(n){console.error("Erreur sauvegarde traitement:",n),alert("Erreur lors de la sauvegarde du traitement")}},[w,i,f]),K=l.useCallback(async e=>{if(window.confirm("ÃŠtes-vous sÃ»r de vouloir supprimer ce traitement ?"))try{const{error:s}=await d.from("treatments").delete().eq("id",e);if(s)throw s;L(n=>n.filter(r=>r.id!==e))}catch(s){console.error("Erreur suppression traitement:",s),alert("Erreur lors de la suppression")}},[]),de=l.useCallback(async e=>{try{const{data:s,error:n}=await d.from("weight_records").insert([{dog_id:i.id,weight:parseFloat(e.weight),measurement_date:new Date(e.date).toISOString().split("T")[0]}]).select().single();if(n)throw n;R(r=>[...r,{date:new Date(e.date).toLocaleDateString("fr-FR"),weight:parseFloat(e.weight)}]),f("weight")}catch(s){console.error("Erreur sauvegarde poids:",s),alert("Erreur lors de la sauvegarde du poids")}},[i,f]),me=l.useCallback(async e=>{try{const{error:s}=await d.from("dogs").update({name:e.name,breed:e.breed,gender:e.gender,weight:parseFloat(e.weight.replace(" kg","")),is_sterilized:e.sterilized==="StÃ©rilisÃ©",notes:e.notes,microchip_number:e.microchip_number}).eq("id",i.id);if(s)throw s;T(e),$(n=>n.map(r=>r.id===i.id?e:r)),f("editProfile")}catch(s){console.error("Erreur sauvegarde profil:",s),alert("Erreur lors de la sauvegarde du profil")}},[i,f]),ue=l.useCallback(async e=>{try{const{error:s}=await d.from("dogs").update({photo_url:e}).eq("id",i.id);if(s)throw s;T(n=>({...n,image:e})),$(n=>n.map(r=>r.id===i.id?{...r,image:e}:r))}catch(s){console.error("Erreur mise Ã  jour photo de profil:",s),alert("âŒ Erreur lors de la mise Ã  jour de la photo de profil")}},[i]),he=l.useCallback(async e=>{var r;const s=(r=e.target.files)==null?void 0:r[0];if(!s)return;if(!s.name||typeof s.name!="string"){alert("âš ï¸ Fichier invalide");return}if(s.size>5*1024*1024){alert("âš ï¸ L'image est trop volumineuse (max 5MB)");return}if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(s.type)){alert("âš ï¸ Format non supportÃ©. Utilisez JPG, PNG ou WEBP");return}G(!0);try{const a=s.name.split(".").pop().toLowerCase(),o=`${c.id}/${i.id}/cover_${Date.now()}.${a}`,{error:m}=await d.storage.from("dog-photos").upload(o,s,{contentType:s.type,cacheControl:"3600",upsert:!1});if(m){if(m.message.includes("Bucket not found")){alert(`âš ï¸ Le bucket de stockage n'existe pas.

ðŸ“‹ Instructions:
1. Va dans Supabase > Storage
2. CrÃ©e un bucket "dog-photos"
3. Coche "Public bucket"
4. RÃ©essaye`);return}throw m}const{data:{publicUrl:b}}=d.storage.from("dog-photos").getPublicUrl(o),{error:N}=await d.from("dogs").update({cover_photo_url:b}).eq("id",i.id);if(N)throw N;T(u=>({...u,cover_photo_url:b})),$(u=>u.map(g=>g.id===i.id?{...g,cover_photo_url:b}:g)),alert("âœ… Photo de couverture mise Ã  jour !"),e.target.value=""}catch(a){console.error("Erreur upload cover:",a),alert("âŒ Erreur lors de l'upload: "+a.message)}finally{G(!1)}},[c,i]),pe=l.useCallback(async e=>{if(!e){alert("âš ï¸ Aucun fichier sÃ©lectionnÃ©");return}if(!e.name||typeof e.name!="string"){alert("âš ï¸ Fichier invalide");return}if(e.size>5*1024*1024){alert("âš ï¸ L'image est trop volumineuse (max 5MB)");return}if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)){alert("âš ï¸ Format non supportÃ©. Utilisez JPG, PNG ou WEBP");return}try{const n=e.name.split(".").pop().toLowerCase(),r=`${c.id}/${i.id}/${Date.now()}.${n}`,{error:a}=await d.storage.from("dog-photos").upload(r,e,{contentType:e.type,cacheControl:"3600",upsert:!1});if(a){if(a.message.includes("Bucket not found")){alert(`âš ï¸ Le bucket de stockage n'existe pas.

ðŸ“‹ Instructions:
1. Va dans Supabase > Storage
2. CrÃ©e un bucket "dog-photos"
3. Coche "Public bucket"
4. RÃ©essaye`);return}throw a}const{data:{publicUrl:o}}=d.storage.from("dog-photos").getPublicUrl(r),{data:m,error:b}=await d.from("dog_photos").insert([{dog_id:i.id,photo_url:o,created_at:new Date().toISOString()}]).select().single();if(b){if(b.message.includes('relation "dog_photos" does not exist')){alert(`âš ï¸ La table dog_photos n'existe pas.

ðŸ“‹ ExÃ©cute le SQL:
CREATE TABLE dog_photos (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  dog_id UUID REFERENCES dogs(id) ON DELETE CASCADE,
  photo_url TEXT NOT NULL,
  created_at TIMESTAMP DEFAULT NOW()
);`);return}throw b}W(N=>[m,...N]),alert("âœ… Photo ajoutÃ©e avec succÃ¨s !")}catch(n){console.error("Erreur upload photo:",n),alert("âŒ Erreur lors de l'upload: "+n.message)}},[c,i]),Q=e=>{if(!e)return"";let s=e.normalize("NFD");return s=s.replace(/[\u0300-\u036f]/g,""),s=s.replace(/Å“/g,"oe").replace(/Ã¦/g,"ae").replace(/Å’/g,"OE").replace(/Ã†/g,"AE").replace(/[â‚¬Â£$Â¥]/g,"").replace(/[Â«Â»]/g,"").replace(/[^a-zA-Z0-9\s.,;:!?()\-'"\/&@#%+=_]/g," "),s=s.replace(/\s+/g," "),s=s.trim(),s},X=l.useCallback(async()=>{if(!k){E(!0);return}q(!0);try{const e=new Ce({orientation:"p",unit:"mm",format:"a4",compress:!0}),s=e.internal.pageSize.getWidth(),n=e.internal.pageSize.getHeight(),r=20;let a=r;const o=(u,g,te,ae={})=>{try{const M=String(u||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x00-\x7F]/g,"");e.text(M,g,te,ae)}catch(M){console.error("Erreur ajout texte:",M),e.text("Error",g,te,ae)}};e.setFillColor(59,130,246),e.rect(0,0,s,50,"F"),e.setTextColor(255,255,255),e.setFontSize(28),e.setFont("helvetica","bold"),o("WOOFLY",r,25),e.setFontSize(14),e.setFont("helvetica","normal"),o("Carnet de Sante",r,38),a=60,e.setTextColor(0,0,0),e.setFontSize(22),e.setFont("helvetica","bold"),o(i.name,r,a),a+=10,e.setFontSize(11),e.setFont("helvetica","normal"),e.setTextColor(100,100,100);const m=i.gender==="male"?"Male":"Femelle";o(`${i.breed} - ${i.age} - ${m}`,r,a),a+=6,i.weight!=="Non renseigne"&&(o(`Poids: ${i.weight}`,r,a),a+=6),i.microchip_number&&(o(`Puce: ${i.microchip_number}`,r,a),a+=6),o(`Sterilisation: ${i.sterilized}`,r,a),a+=15,e.setFontSize(16),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),o("VACCINATIONS",r,a),a+=8,z.length===0?(e.setFontSize(10),e.setFont("helvetica","italic"),e.setTextColor(150,150,150),o("Aucune vaccination enregistree",r+5,a),a+=10):(e.setFontSize(10),e.setFont("helvetica","normal"),z.forEach(u=>{a>n-40&&(e.addPage(),a=r),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),o(`- ${u.name}`,r+5,a),a+=5,e.setFont("helvetica","normal"),e.setTextColor(80,80,80),o(`  Derniere date: ${u.lastDate}`,r+5,a),a+=5,o(`  Prochaine date: ${u.nextDate}`,r+5,a),a+=5,u.veterinarian&&(o(`  Veterinaire: ${u.veterinarian}`,r+5,a),a+=5),a+=3})),a+=8,a>n-60&&(e.addPage(),a=r),e.setFontSize(16),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),o("TRAITEMENTS",r,a),a+=8,P.length===0?(e.setFontSize(10),e.setFont("helvetica","italic"),e.setTextColor(150,150,150),o("Aucun traitement enregistre",r+5,a),a+=10):(e.setFontSize(10),e.setFont("helvetica","normal"),P.forEach(u=>{a>n-40&&(e.addPage(),a=r);const g=u.type==="worm"?"Vermifuge":"Anti-puces/tiques";e.setFont("helvetica","bold"),e.setTextColor(0,0,0),o(`- ${u.product} (${g})`,r+5,a),a+=5,e.setFont("helvetica","normal"),e.setTextColor(80,80,80),o(`  Derniere date: ${u.lastDate}`,r+5,a),a+=5,o(`  Prochaine date: ${u.nextDate}`,r+5,a),a+=8})),a+=8,a>n-60&&(e.addPage(),a=r),e.setFontSize(16),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),o("EVOLUTION DU POIDS",r,a),a+=8,C.length===0?(e.setFontSize(10),e.setFont("helvetica","italic"),e.setTextColor(150,150,150),o("Aucune pesee enregistree",r+5,a),a+=10):(e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(80,80,80),C.slice(-5).forEach(g=>{o(`- ${g.date}: ${g.weight} kg`,r+5,a),a+=5}),C.length>5&&(a+=3,e.setFont("helvetica","italic"),o(`(${C.length-5} autres pesees non affichees)`,r+5,a))),a+=12,a>n-80&&(e.addPage(),a=r),e.setFontSize(16),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),o("NOTES MEDICALES",r,a),a+=8,e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(80,80,80),v.allergies&&(e.setFont("helvetica","bold"),o("Allergies:",r+5,a),a+=5,e.setFont("helvetica","normal"),e.splitTextToSize(Q(v.allergies),s-r*2-10).forEach(g=>{o(g,r+5,a),a+=5}),a+=5),v.medications&&(e.setFont("helvetica","bold"),o("Medicaments:",r+5,a),a+=5,e.setFont("helvetica","normal"),e.splitTextToSize(Q(v.medications),s-r*2-10).forEach(g=>{o(g,r+5,a),a+=5}),a+=5),v.veterinarian&&(e.setFont("helvetica","bold"),o("Veterinaire:",r+5,a),a+=5,e.setFont("helvetica","normal"),o(v.veterinarian,r+5,a),a+=5),v.veterinarianPhone&&(o(`Telephone: ${v.veterinarianPhone}`,r+5,a),a+=5),!v.allergies&&!v.medications&&!v.veterinarian&&(e.setFont("helvetica","italic"),e.setTextColor(150,150,150),o("Aucune note medicale enregistree",r+5,a)),e.setTextColor(150,150,150),e.setFontSize(8),o("Genere avec Woofly - www.doogybook.com",s/2,n-10,{align:"center"}),o(`Date: ${new Date().toLocaleDateString("fr-FR")}`,s-r,n-10,{align:"right"});const N=`carnet-sante-${i.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.pdf`;e.save(N),alert("Carnet de sante telecharge avec succes !")}catch(e){console.error("Erreur generation PDF:",e),alert("Erreur lors de la generation du PDF: "+e.message)}finally{q(!1)}},[k,i,z,P,C,v]);l.useCallback(e=>{T(e)},[]);const xe=[{id:"vaccinations",label:"Vaccinations",icon:"Syringe"},{id:"vermifuge",label:"Vermifuge",icon:"Pill"},{id:"flea",label:"Anti-puces",icon:"Bug"},{id:"weight",label:"Poids",icon:"TrendingUp"},{id:"notes",label:"Notes mÃ©dicales",icon:"FileText"}],Z=P.filter(e=>e.type==="worm"),ee=P.filter(e=>e.type==="flea"||e.type==="tick");return x?t.jsx("div",{className:"min-h-[100dvh] sm:min-h-screen bg-background flex items-center justify-center p-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary mb-4"}),t.jsx("p",{className:"text-muted-foreground",children:"Chargement du profil..."})]})}):i?t.jsxs("div",{className:"min-h-[100dvh] sm:min-h-screen bg-background flex flex-col",children:[t.jsx("div",{className:"sticky top-0 z-50 bg-card border-b border-border shadow-soft px-3 sm:px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsx("h1",{className:"text-lg sm:text-xl font-heading font-semibold text-foreground truncate flex-1",children:i.name}),t.jsx("button",{onClick:X,disabled:D,className:"hidden sm:flex items-center gap-2 px-3 sm:px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-medium hover:shadow-lg transition-all disabled:opacity-50 min-h-[44px] text-sm",children:D?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),t.jsx("span",{children:"Export..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(h,{name:"Download",size:16}),t.jsx("span",{children:"Carnet PDF"})]})}),t.jsx(fe,{})]})}),t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"relative h-32 sm:h-40 bg-gradient-to-br from-blue-500 to-purple-600 overflow-hidden",children:[i.cover_photo_url?t.jsx(U,{src:i.cover_photo_url,alt:`Couverture de ${i.name}`,width:1200,quality:85,eager:!0,className:"w-full h-full object-cover"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center text-white/30",children:t.jsx(h,{name:"Image",size:24})}),t.jsxs("label",{htmlFor:"cover-photo-upload-input",className:"absolute bottom-2 sm:bottom-3 right-2 sm:right-3 z-10 bg-white/90 hover:bg-white px-2.5 sm:px-3 py-2 rounded-lg cursor-pointer shadow-lg transition-smooth flex items-center gap-1.5 sm:gap-2 min-h-[44px]",children:[t.jsx(h,{name:"Camera",size:16}),t.jsx("span",{className:"font-medium text-xs sm:text-sm",children:B?"Upload...":"Modifier"}),t.jsx("input",{id:"cover-photo-upload-input",type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:he,className:"hidden",disabled:B})]})]}),t.jsx("div",{className:"relative max-w-7xl mx-auto px-3 sm:px-4",children:t.jsxs("div",{className:"flex items-end gap-3 sm:gap-4 -mt-10 sm:-mt-12 pb-3 sm:pb-4",children:[t.jsxs("div",{className:"relative flex-shrink-0",children:[t.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full border-4 border-card bg-gradient-to-br from-blue-500 to-purple-600 overflow-hidden shadow-xl",children:t.jsx(U,{src:i.image,alt:i.name,width:200,quality:80,eager:!0,className:"w-full h-full object-cover"})}),t.jsx("button",{onClick:()=>j("gallery"),className:"absolute bottom-0 right-0 bg-primary hover:bg-primary/90 text-white p-1.5 sm:p-2 rounded-full cursor-pointer shadow-lg transition-smooth min-w-[36px] min-h-[36px] flex items-center justify-center",children:t.jsx(h,{name:"Camera",size:14,className:"sm:w-4 sm:h-4"})})]}),t.jsxs("div",{className:"flex-1 pb-1 min-w-0",children:[t.jsx("h2",{className:"text-xl sm:text-2xl font-heading font-bold text-foreground truncate",children:i.name}),t.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-1.5 text-muted-foreground text-xs mt-1",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(h,{name:"Dog",size:12}),t.jsx("span",{className:"truncate max-w-[100px] sm:max-w-none",children:i.breed})]}),t.jsx("span",{className:"text-gray-300",children:"â€¢"}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(h,{name:"Calendar",size:12}),t.jsx("span",{className:"whitespace-nowrap",children:i.age})]}),t.jsx("span",{className:"text-gray-300",children:"â€¢"}),t.jsx("span",{className:"flex items-center gap-1",children:i.gender==="male"?t.jsxs(t.Fragment,{children:[t.jsx(h,{name:"Mars",size:12}),t.jsx("span",{children:"MÃ¢le"})]}):t.jsxs(t.Fragment,{children:[t.jsx(h,{name:"Venus",size:12}),t.jsx("span",{children:"Femelle"})]})})]})]})]})})]}),t.jsx(se,{}),t.jsx("main",{className:"main-content flex-1 pb-20",children:t.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-3 sm:py-4",children:t.jsx("div",{className:"mt-3 sm:mt-4",children:t.jsxs("div",{className:"bg-card rounded-lg shadow-soft overflow-hidden",children:[t.jsx("div",{className:"border-b border-border overflow-x-auto",children:t.jsx("div",{className:"flex min-w-max px-2",children:xe.map(e=>t.jsxs("button",{onClick:()=>S(e.id),className:`flex items-center gap-2 px-3 sm:px-4 py-3 font-medium transition-smooth border-b-2 text-xs sm:text-sm min-h-[44px] ${p===e.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"}`,children:[t.jsx(h,{name:e.icon,size:16,className:"sm:w-[18px] sm:h-[18px]"}),t.jsx("span",{className:"whitespace-nowrap",children:e.label})]},e.id))})}),t.jsxs("div",{className:"p-3 sm:p-4",children:[p==="vaccinations"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex flex-col items-start justify-between gap-3 mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-base sm:text-lg font-heading font-semibold text-foreground mb-1",children:"Vaccinations"}),t.jsxs("p",{className:"text-xs text-muted-foreground font-caption",children:["GÃ©rez le calendrier vaccinal de ",i.name]})]}),t.jsx(y,{variant:"default",iconName:"Plus",iconPosition:"left",onClick:()=>j("vaccination"),size:"sm",className:"w-full min-h-[44px]",children:"Ajouter une vaccination"})]}),z.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(h,{name:"Syringe",size:24,color:"var(--color-muted-foreground)"})}),t.jsx("p",{className:"text-sm text-muted-foreground font-caption mb-4",children:"Aucune vaccination enregistrÃ©e"}),t.jsx(y,{variant:"default",iconName:"Plus",iconPosition:"left",onClick:()=>j("vaccination"),size:"sm",className:"w-full min-h-[44px]",children:"Ajouter une vaccination"})]}):t.jsx("div",{className:"grid grid-cols-1 gap-3",children:z.map(e=>t.jsx(ve,{vaccination:e,onEdit:s=>j("vaccination",s),onDelete:ce},e.id))})]}),p==="vermifuge"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex flex-col items-start justify-between gap-3 mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-base sm:text-lg font-heading font-semibold text-foreground mb-1",children:"Vermifuge"}),t.jsx("p",{className:"text-xs text-muted-foreground font-caption",children:"Suivez les traitements antiparasitaires internes"})]}),t.jsx(y,{variant:"default",iconName:"Plus",iconPosition:"left",onClick:()=>j("vermifuge"),size:"sm",className:"w-full min-h-[44px]",children:"Ajouter un traitement"})]}),Z.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(h,{name:"Pill",size:24,color:"var(--color-muted-foreground)"})}),t.jsx("p",{className:"text-sm text-muted-foreground font-caption mb-4",children:"Aucun traitement vermifuge enregistrÃ©"}),t.jsx(y,{variant:"default",iconName:"Plus",iconPosition:"left",onClick:()=>j("vermifuge"),size:"sm",className:"w-full min-h-[44px]",children:"Ajouter un traitement"})]}):t.jsx("div",{className:"grid grid-cols-1 gap-3",children:Z.map(e=>t.jsx(re,{treatment:e,type:"vermifuge",onEdit:s=>j("vermifuge",s),onDelete:s=>K(s)},e.id))})]}),p==="flea"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex flex-col items-start justify-between gap-3 mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-base sm:text-lg font-heading font-semibold text-foreground mb-1",children:"Anti-puces et tiques"}),t.jsx("p",{className:"text-xs text-muted-foreground font-caption",children:"GÃ©rez les traitements antiparasitaires externes"})]}),t.jsx(y,{variant:"default",iconName:"Plus",iconPosition:"left",onClick:()=>j("flea"),size:"sm",className:"w-full min-h-[44px]",children:"Ajouter un traitement"})]}),ee.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(h,{name:"Bug",size:24,color:"var(--color-muted-foreground)"})}),t.jsx("p",{className:"text-sm text-muted-foreground font-caption mb-4",children:"Aucun traitement anti-puces enregistrÃ©"}),t.jsx(y,{variant:"default",iconName:"Plus",iconPosition:"left",onClick:()=>j("flea"),size:"sm",className:"w-full min-h-[44px]",children:"Ajouter un traitement"})]}):t.jsx("div",{className:"grid grid-cols-1 gap-3",children:ee.map(e=>t.jsx(re,{treatment:e,type:"flea",onEdit:s=>j("flea",s),onDelete:s=>K(s)},e.id))})]}),p==="weight"&&t.jsx(be,{data:C,onAddWeight:()=>j("weight")}),p==="notes"&&t.jsx(we,{notes:v,onSave:V})]})]})})})}),t.jsx("button",{onClick:X,disabled:D,className:"sm:hidden fixed bottom-20 right-3 sm:right-4 z-40 w-14 h-14 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-full shadow-lg flex items-center justify-center disabled:opacity-50",children:D?t.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}):t.jsx(h,{name:"Download",size:22})}),t.jsx(je,{isOpen:F.vaccination,onClose:()=>f("vaccination"),onSave:le,editData:w}),t.jsx(ie,{isOpen:F.vermifuge,onClose:()=>f("vermifuge"),onSave:e=>J(e,"vermifuge"),editData:w,type:"vermifuge"}),t.jsx(ie,{isOpen:F.flea,onClose:()=>f("flea"),onSave:e=>J(e,"flea"),editData:w,type:"flea"}),t.jsx(Ne,{isOpen:F.weight,onClose:()=>f("weight"),onSave:de}),t.jsx(ye,{isOpen:F.editProfile,onClose:()=>f("editProfile"),onSave:me,profile:i}),t.jsx(_e,{isOpen:F.gallery,onClose:()=>f("gallery"),photos:oe,onAddPhoto:pe,currentProfilePhotoUrl:i==null?void 0:i.image,onSetProfilePhoto:ue}),t.jsx(De,{isOpen:O,onClose:()=>E(!1),reason:"health-pdf"}),t.jsx(Se,{})]}):t.jsxs("div",{className:"min-h-[100dvh] sm:min-h-screen bg-background",children:[t.jsx(se,{}),t.jsx(Fe,{})]})};export{Be as default};
