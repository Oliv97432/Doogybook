import{u as S,s as j,j as e}from"./index-D6tTS0JU.js";import{d as E,r as n}from"./vendor-react-DEK6ZklB.js";import{U as F}from"./UserMenuPro-Cm82gngU.js";import{n as R,m as M,H as f,a4 as N,ai as v,j as U,g as y}from"./vendor-ui-DSVO5Hq3.js";import"./vendor-supabase-DfwcnzK-.js";const B=()=>{const{user:c}=S(),l=E(),[w,_]=n.useState(!0),[P,k]=n.useState(null),[C,D]=n.useState([]),[i,z]=n.useState(""),[a,m]=n.useState("all");n.useEffect(()=>{c&&$()},[c]);const $=async()=>{try{const{data:s,error:t}=await j.from("professional_accounts").select("*").eq("user_id",c.id).single();if(t)throw t;k(s),A(s.id)}catch(s){console.error("Erreur:",s),l("/pro/register")}},A=async s=>{try{const{data:t,error:r}=await j.from("dogs").select(`
          *,
          foster_family:contacts!dogs_foster_family_contact_id_fkey(
            id,
            full_name,
            email,
            city
          ),
          placement_history!placement_history_dog_id_fkey(
            id,
            start_date,
            status,
            placement_type
          )
        `).eq("professional_account_id",s).neq("adoption_status","adopted").order("created_at",{ascending:!1});if(r)throw r;D(t||[])}catch(t){console.error("Erreur chargement chiens:",t)}finally{_(!1)}},o=s=>{if(!s)return"";const t=Math.floor((new Date-new Date(s))/(365.25*24*60*60*1e3));return t<1?"Moins d'1 an":`${t} an${t>1?"s":""}`},L=s=>{if(!s.placement_history||s.placement_history.length===0)return null;const t=s.placement_history.find(r=>r.status==="active"&&r.placement_type==="foster");return t==null?void 0:t.start_date},d=C.filter(s=>{var h,p,g,b;const t=((h=s.name)==null?void 0:h.toLowerCase().includes(i.toLowerCase()))||((p=s.breed)==null?void 0:p.toLowerCase().includes(i.toLowerCase()))||((b=(g=s.foster_family)==null?void 0:g.full_name)==null?void 0:b.toLowerCase().includes(i.toLowerCase()));let r=!0;return a==="foster"?r=!!s.foster_family_contact_id:a==="available"&&(r=!s.foster_family_contact_id),t&&r}),x=d.filter(s=>s.foster_family_contact_id),u=d.filter(s=>!s.foster_family_contact_id);return w?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-primary border-t-transparent rounded-full"})}):e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-card border-b border-border shadow-soft",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-3 sm:py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[e.jsxs("button",{onClick:()=>l("/pro/dashboard"),className:"flex items-center gap-1 sm:gap-2 text-gray-600 hover:text-gray-900 min-h-[44px] min-w-[44px]",children:[e.jsx(R,{size:18,className:"sm:size-5"}),e.jsx("span",{className:"font-medium text-sm sm:text-base hidden xs:inline",children:"Dashboard"})]}),e.jsx("h1",{className:"text-lg sm:text-xl font-heading font-bold text-foreground",children:"Liste des chiens"}),e.jsx(F,{})]}),e.jsxs("div",{className:"flex flex-col xs:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",size:18}),e.jsx("input",{type:"text",value:i,onChange:s=>z(s.target.value),placeholder:"Rechercher un chien ou une FA...",className:"w-full pl-9 sm:pl-10 pr-4 py-3 border border-border rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-sm"})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 xs:pb-0",children:[e.jsx("button",{onClick:()=>m("all"),className:`px-4 py-2 rounded-lg font-medium text-sm whitespace-nowrap transition-smooth ${a==="all"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"Tous"}),e.jsx("button",{onClick:()=>m("foster"),className:`px-4 py-2 rounded-lg font-medium text-sm whitespace-nowrap transition-smooth ${a==="foster"?"bg-purple-500 text-white":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"En FA"}),e.jsx("button",{onClick:()=>m("available"),className:`px-4 py-2 rounded-lg font-medium text-sm whitespace-nowrap transition-smooth ${a==="available"?"bg-green-500 text-white":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:"Disponibles"})]})]})]})}),e.jsx("main",{className:"main-content flex-1",children:e.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-6",children:d.length===0?e.jsxs("div",{className:"bg-card rounded-xl shadow-soft p-12 text-center",children:[e.jsx(f,{size:40,className:"text-muted-foreground mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-muted-foreground",children:i?"Aucun chien trouvé":"Aucun chien à afficher"})]}):e.jsxs("div",{className:"space-y-8",children:[(a==="all"||a==="foster")&&x.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(N,{size:20,className:"text-purple-600"})}),e.jsx("h2",{className:"text-lg sm:text-xl font-heading font-bold text-foreground",children:"En famille d'accueil"}),e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-bold",children:x.length})]}),e.jsx("div",{className:"space-y-3",children:x.map(s=>{var r;const t=L(s);return e.jsx("div",{className:"bg-card rounded-xl shadow-soft border border-border p-4 hover:shadow-lg transition-all",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx("div",{onClick:()=>l(`/pro/dogs/${s.id}`),className:"cursor-pointer flex-shrink-0",children:s.photo_url?e.jsx("img",{src:s.photo_url,alt:s.name,className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full object-cover ring-2 ring-purple-200"}):e.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-gradient-to-br from-purple-400 to-purple-600 flex items-center justify-center ring-2 ring-purple-200",children:e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white",children:(r=s.name)==null?void 0:r.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsxs("button",{onClick:()=>l(`/pro/dogs/${s.id}`),className:"text-base sm:text-lg font-bold text-foreground hover:text-primary transition-colors truncate",children:[s.name,s.is_urgent&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:"URGENT"})]}),e.jsx(v,{size:20,className:"text-muted-foreground flex-shrink-0 hidden sm:block"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:[s.breed,o(s.birth_date)&&` • ${o(s.birth_date)}`,s.gender&&` • ${s.gender==="male"?"Mâle":"Femelle"}`]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("button",{onClick:()=>l(`/pro/crm/contacts/${s.foster_family.id}`),className:"flex items-center gap-2 text-sm font-medium text-purple-600 hover:text-purple-700 transition-colors",children:[e.jsx(N,{size:16,className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.foster_family.full_name})]}),s.foster_family.city&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(U,{size:14,className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.foster_family.city})]}),t&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(y,{size:14,className:"flex-shrink-0"}),e.jsxs("span",{className:"whitespace-nowrap",children:["Depuis le ",new Date(t).toLocaleDateString("fr-FR")]})]})]})]})]})},s.id)})})]}),(a==="all"||a==="available")&&u.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(f,{size:20,className:"text-green-600"})}),e.jsx("h2",{className:"text-lg sm:text-xl font-heading font-bold text-foreground",children:"Disponibles au refuge"}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold",children:u.length})]}),e.jsx("div",{className:"space-y-3",children:u.map(s=>{var t;return e.jsx("div",{className:"bg-card rounded-xl shadow-soft border border-border p-4 hover:shadow-lg transition-all",children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[e.jsx("div",{onClick:()=>l(`/pro/dogs/${s.id}`),className:"cursor-pointer flex-shrink-0",children:s.photo_url?e.jsx("img",{src:s.photo_url,alt:s.name,className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full object-cover ring-2 ring-green-200"}):e.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-gradient-to-br from-green-400 to-green-600 flex items-center justify-center ring-2 ring-green-200",children:e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white",children:(t=s.name)==null?void 0:t.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsxs("button",{onClick:()=>l(`/pro/dogs/${s.id}`),className:"text-base sm:text-lg font-bold text-foreground hover:text-primary transition-colors truncate",children:[s.name,s.is_urgent&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:"URGENT"})]}),e.jsx(v,{size:20,className:"text-muted-foreground flex-shrink-0 hidden sm:block"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:[s.breed,o(s.birth_date)&&` • ${o(s.birth_date)}`,s.gender&&` • ${s.gender==="male"?"Mâle":"Femelle"}`]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm text-green-600 font-medium",children:[e.jsx(f,{size:16,className:"flex-shrink-0"}),e.jsx("span",{children:"Disponible au refuge"})]}),s.arrival_date&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(y,{size:14,className:"flex-shrink-0"}),e.jsxs("span",{className:"whitespace-nowrap",children:["Depuis le ",new Date(s.arrival_date).toLocaleDateString("fr-FR")]})]})]})]})]})},s.id)})})]})]})})})]})};export{B as default};
