import{j as e,I as u,u as V,s as w}from"./index-B7Jx57M6.js";import{r as p}from"./vendor-react-DEK6ZklB.js";import{T as B}from"./TabNavigation-BwiyMJ_q.js";import{U as L}from"./UserMenu-BLe4sAG0.js";import{B as b}from"./Button-DRPe_8g_.js";import{I as q}from"./Input-B_atqvlr.js";import{F as D}from"./Footer-BzsNiuzK.js";import"./vendor-ui-BmzNxrw7.js";import"./vendor-supabase-DfwcnzK-.js";import"./PremiumBadge-CXujHqOf.js";const F=({contact:s,onCall:i,onMap:a})=>{var x;const n=j=>{switch(j){case"24/7":return"text-success bg-success/10";case"Ouvert":return"text-primary bg-primary/10";case"Fermé":return"text-muted-foreground bg-muted";default:return"text-muted-foreground bg-muted"}},d=j=>{switch(j){case"personal":return"Stethoscope";case"emergency":return"AlertCircle";case"clinic":return"Building2";case"association":return"Heart";default:return"Phone"}};return e.jsx("div",{className:"bg-card rounded-lg p-6 shadow-soft hover:shadow-elevated transition-smooth border border-border",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(u,{name:d(s==null?void 0:s.category),size:24,color:"var(--color-primary)"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-heading font-semibold text-foreground mb-1",children:s==null?void 0:s.name}),(s==null?void 0:s.specialization)&&e.jsx("p",{className:"text-sm text-muted-foreground font-caption",children:s==null?void 0:s.specialization})]}),(s==null?void 0:s.status)&&e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${n(s==null?void 0:s.status)}`,children:s==null?void 0:s.status})]}),(s==null?void 0:s.rating)&&e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((j,f)=>e.jsx(u,{name:(f<Math.floor(s==null?void 0:s.rating),"Star"),size:16,color:f<Math.floor(s==null?void 0:s.rating)?"#F59E0B":"#E5E7EB",strokeWidth:f<Math.floor(s==null?void 0:s.rating)?0:2,className:f<Math.floor(s==null?void 0:s.rating)?"fill-current":""},f))}),e.jsxs("span",{className:"text-sm text-muted-foreground font-caption",children:[(x=s==null?void 0:s.rating)==null?void 0:x.toFixed(1)," (",s==null?void 0:s.reviewCount," avis)"]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(u,{name:"Phone",size:16,className:"text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsx("a",{href:`tel:${s==null?void 0:s.phone}`,className:"text-sm text-foreground hover:text-primary transition-smooth font-caption",children:s==null?void 0:s.phone})]}),(s==null?void 0:s.address)&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(u,{name:"MapPin",size:16,className:"text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-foreground font-caption",children:s==null?void 0:s.address})]}),(s==null?void 0:s.hours)&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(u,{name:"Clock",size:16,className:"text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-foreground font-caption",children:s==null?void 0:s.hours})]}),(s==null?void 0:s.certification)&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(u,{name:"Award",size:16,className:"text-primary mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-primary font-caption font-medium",children:s==null?void 0:s.certification})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(b,{variant:"default",size:"sm",iconName:"Phone",iconPosition:"left",onClick:()=>i(s==null?void 0:s.phone),children:"Appeler"}),(s==null?void 0:s.address)&&e.jsx(b,{variant:"outline",size:"sm",iconName:"MapPin",iconPosition:"left",onClick:()=>a(s),children:"Itinéraire"}),(s==null?void 0:s.website)&&e.jsx(b,{variant:"ghost",size:"sm",iconName:"Globe",iconPosition:"left",onClick:()=>window.open(s==null?void 0:s.website,"_blank"),children:"Site web"})]})]})]})})},O=({title:s,description:i,icon:a,count:n,isActive:d,onClick:x})=>e.jsx("button",{onClick:x,className:`w-full p-4 rounded-lg border transition-smooth text-left ${d?"bg-primary/10 border-primary":"bg-card border-border hover:border-primary/50"}`,"aria-pressed":d,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 ${d?"bg-primary/20":"bg-muted"}`,children:e.jsx(u,{name:a,size:20,color:d?"var(--color-primary)":"var(--color-muted-foreground)"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[e.jsx("h3",{className:`font-heading font-semibold ${d?"text-primary":"text-foreground"}`,children:s}),n>0&&e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${d?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:n})]}),e.jsx("p",{className:"text-sm text-muted-foreground font-caption",children:i})]})]})}),R=({onEmergencyCall:s})=>{const{user:i}=V(),[a,n]=p.useState({name:"",address:"",phone:""}),[d,x]=p.useState(!1),[j,f]=p.useState(!0),[t,v]=p.useState({name:"",address:"",phone:""});p.useEffect(()=>{i!=null&&i.id&&c()},[i==null?void 0:i.id]);const c=async()=>{try{f(!0);const{data:l,error:g}=await w.from("user_emergency_contacts").select("*").eq("user_id",i.id).single();g&&g.code!=="PGRST116"&&console.error("Error loading emergency contacts:",g),l&&n({name:l.veterinarian_name||"",address:l.veterinarian_address||"",phone:l.veterinarian_phone||""})}catch(l){console.error("Error in loadEmergencyContacts:",l)}finally{f(!1)}},o=async l=>{try{const{error:g}=await w.from("user_emergency_contacts").upsert({user_id:i.id,...l,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(g)throw g;return await c(),!0}catch(g){return console.error("Error saving emergency contacts:",g),alert("❌ Erreur lors de la sauvegarde"),!1}},N=async()=>{await o({veterinarian_name:t.name,veterinarian_address:t.address,veterinarian_phone:t.phone})&&(x(!1),alert("✅ Vétérinaire enregistré !"))};return e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(u,{name:"Stethoscope",size:24,className:"text-blue-500"}),"Mon Vétérinaire"]}),e.jsx(b,{variant:"outline",size:"sm",iconName:"Edit",iconPosition:"left",onClick:()=>{v(a),x(!0)},children:"Modifier"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Gardez les coordonnées de votre vétérinaire à portée de main"}),a.name?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{name:"Stethoscope",size:20,className:"text-blue-500"}),e.jsx("span",{className:"font-semibold text-gray-900",children:a.name})]}),a.address&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{name:"MapPin",size:20,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-700",children:a.address})]}),a.phone&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{name:"Phone",size:20,className:"text-green-500"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:a.phone})]}),a.phone&&e.jsx(b,{variant:"default",size:"lg",iconName:"Phone",iconPosition:"left",onClick:()=>window.location.href=`tel:${a.phone}`,className:"w-full mt-4",children:"Appeler mon vétérinaire"})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"Aucun vétérinaire enregistré"}),e.jsx(b,{variant:"default",iconName:"Plus",iconPosition:"left",onClick:()=>{v({name:"",address:"",phone:""}),x(!0)},children:"Ajouter mon vétérinaire"})]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Mon Vétérinaire"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Nom du vétérinaire *"}),e.jsx("input",{type:"text",value:t.name,onChange:l=>v({...t,name:l.target.value}),placeholder:"Dr. Martin",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Adresse"}),e.jsx("input",{type:"text",value:t.address,onChange:l=>v({...t,address:l.target.value}),placeholder:"15 Rue de la Santé, 75014 Paris",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Téléphone *"}),e.jsx("input",{type:"tel",value:t.phone,onChange:l=>v({...t,phone:l.target.value}),placeholder:"01 42 56 78 90",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{variant:"outline",onClick:()=>x(!1),className:"flex-1",children:"Annuler"}),e.jsx(b,{variant:"default",onClick:N,disabled:!t.name||!t.phone,className:"flex-1",children:"Enregistrer"})]})]})})]})},T=({value:s,onChange:i,placeholder:a})=>e.jsx("div",{className:"mb-6",children:e.jsx(q,{type:"search",placeholder:a||"Rechercher un vétérinaire, une clinique...",value:s,onChange:n=>{var d;return i((d=n==null?void 0:n.target)==null?void 0:d.value)},className:"w-full"})}),U=({contact:s,onClose:i})=>{if(!s)return null;const a=`https://www.google.com/maps?q=${encodeURIComponent(s==null?void 0:s.address)}&z=14&output=embed`;return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[200] p-4",onClick:i,children:e.jsxs("div",{className:"bg-card rounded-lg shadow-elevated max-w-4xl w-full max-h-[90vh] overflow-hidden",onClick:n=>n==null?void 0:n.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[e.jsx("h3",{className:"text-lg font-heading font-semibold text-foreground mb-1",children:s==null?void 0:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground font-caption",children:s==null?void 0:s.address})]}),e.jsx("button",{onClick:i,className:"w-8 h-8 rounded-lg hover:bg-muted transition-smooth flex items-center justify-center flex-shrink-0","aria-label":"Fermer la carte",children:e.jsx(u,{name:"X",size:20})})]}),e.jsx("div",{className:"h-[500px] w-full",children:e.jsx("iframe",{width:"100%",height:"100%",loading:"lazy",title:s==null?void 0:s.name,referrerPolicy:"no-referrer-when-downgrade",src:a,className:"border-0"})}),e.jsxs("div",{className:"p-4 border-t border-border flex flex-wrap gap-2",children:[e.jsx(b,{variant:"default",iconName:"Phone",iconPosition:"left",onClick:()=>window.location.href=`tel:${s==null?void 0:s.phone}`,children:"Appeler"}),e.jsx(b,{variant:"outline",iconName:"Navigation",iconPosition:"left",onClick:()=>window.open(`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(s==null?void 0:s.address)}`,"_blank"),children:"Ouvrir dans Maps"})]})]})})},se=()=>{var y,C,P;const{user:s}=V(),[i,a]=p.useState(""),[n,d]=p.useState("all"),[x,j]=p.useState(null),[f,t]=p.useState(null),[v,c]=p.useState([]),o=[{id:1,category:"personal",name:"Dr. Sophie Martin",specialization:"Vétérinaire généraliste",phone:"+33 1 42 56 78 90",address:"15 Rue de la Santé, 75014 Paris",hours:"Lun-Ven: 9h-19h, Sam: 9h-13h",status:"Ouvert",rating:4.8,reviewCount:156,website:"https://example.com",certification:"Ordre National des Vétérinaires"},{id:4,category:"clinic",name:"Clinique Vétérinaire du Parc",specialization:"Chirurgie et médecine générale",phone:"+33 1 45 67 89 12",address:"23 Boulevard Voltaire, 75011 Paris",hours:"Lun-Sam: 8h30-19h30",status:"Ouvert",rating:4.7,reviewCount:198,website:"https://example.com",certification:"Certifié ISO 9001"},{id:5,category:"clinic",name:"Centre Vétérinaire Spécialisé",specialization:"Cardiologie et dermatologie",phone:"+33 1 53 24 68 90",address:"45 Rue du Faubourg Saint-Antoine, 75012 Paris",hours:"Lun-Ven: 9h-18h",status:"Fermé",rating:4.9,reviewCount:124,website:"https://example.com"},{id:6,category:"association",name:"SPA de Paris",specialization:"Protection animale",phone:"+33 1 43 80 40 66",address:"39 Boulevard Berthier, 75017 Paris",hours:"Lun-Dim: 11h-18h",status:"Ouvert",website:"https://example.com",certification:"Reconnue d'utilité publique"},{id:7,category:"association",name:"Fondation 30 Millions d'Amis",specialization:"Défense des animaux",phone:"+33 1 56 59 04 44",address:"40 Cours Albert 1er, 75008 Paris",hours:"Lun-Ven: 9h-17h",status:"Ouvert",website:"https://example.com",certification:"Fondation reconnue"}],N=[{id:"all",title:"Tous les contacts",description:"Afficher tous les contacts disponibles",icon:"List",count:o==null?void 0:o.length},{id:"personal",title:"Mon vétérinaire",description:"Vétérinaire personnel de confiance",icon:"Stethoscope",count:(y=o==null?void 0:o.filter(r=>(r==null?void 0:r.category)==="personal"))==null?void 0:y.length},{id:"clinic",title:"Cliniques locales",description:"Cliniques vétérinaires à proximité",icon:"Building2",count:(C=o==null?void 0:o.filter(r=>(r==null?void 0:r.category)==="clinic"))==null?void 0:C.length},{id:"association",title:"Associations",description:"Organisations de protection animale",icon:"Heart",count:(P=o==null?void 0:o.filter(r=>(r==null?void 0:r.category)==="association"))==null?void 0:P.length}];p.useEffect(()=>{(async()=>{if(s!=null&&s.id)try{const{data:m,error:h}=await w.from("dog_profiles").select("*").eq("user_id",s.id).order("created_at",{ascending:!0});if(h)throw h;m&&m.length>0&&(c(m),f||t(m[0]))}catch(m){console.error("Erreur chargement chiens:",m)}})()},[s==null?void 0:s.id]);const l=p.useMemo(()=>{let r=o;if(n!=="all"&&(r=r==null?void 0:r.filter(m=>(m==null?void 0:m.category)===n)),i!=null&&i.trim()){const m=i==null?void 0:i.toLowerCase();r=r==null?void 0:r.filter(h=>{var S,k,z,M,E,_;return((k=(S=h==null?void 0:h.name)==null?void 0:S.toLowerCase())==null?void 0:k.includes(m))||((M=(z=h==null?void 0:h.specialization)==null?void 0:z.toLowerCase())==null?void 0:M.includes(m))||((_=(E=h==null?void 0:h.address)==null?void 0:E.toLowerCase())==null?void 0:_.includes(m))})}return r},[n,i]),g=r=>{window.location.href=`tel:${r}`},A=r=>{j(r)},I=r=>{window.location.href=`tel:${r}`},$=r=>{t(r)};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"sticky top-0 z-50 bg-card border-b border-border shadow-soft",children:[e.jsx("div",{className:"max-w-screen-xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-heading font-semibold text-foreground",children:"Contacts Importants"}),e.jsx(L,{dogProfiles:v,currentDog:f,onDogChange:$})]})}),e.jsx(B,{})]}),e.jsx("main",{className:"main-content",children:e.jsxs("div",{className:"max-w-screen-xl mx-auto px-4 py-8",children:[e.jsx(R,{onEmergencyCall:I}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("aside",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-card rounded-lg p-4 shadow-soft border border-border sticky top-[180px]",children:[e.jsx("h2",{className:"text-lg font-heading font-semibold text-foreground mb-4",children:"Catégories"}),e.jsx("div",{className:"space-y-2",children:N==null?void 0:N.map(r=>e.jsx(O,{title:r==null?void 0:r.title,description:r==null?void 0:r.description,icon:r==null?void 0:r.icon,count:r==null?void 0:r.count,isActive:n===(r==null?void 0:r.id),onClick:()=>d(r==null?void 0:r.id)},r==null?void 0:r.id))})]})}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx(T,{value:i,onChange:a,placeholder:"Rechercher un vétérinaire, une clinique..."}),(l==null?void 0:l.length)===0?e.jsxs("div",{className:"bg-card rounded-lg p-12 text-center shadow-soft border border-border",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted mx-auto mb-4 flex items-center justify-center",children:e.jsx(u,{name:"Search",size:32,className:"text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-heading font-semibold text-foreground mb-2",children:"Aucun contact trouvé"}),e.jsx("p",{className:"text-muted-foreground font-caption",children:"Essayez de modifier vos critères de recherche ou de sélectionner une autre catégorie."})]}):e.jsx("div",{className:"space-y-4",children:l==null?void 0:l.map(r=>e.jsx(F,{contact:r,onCall:g,onMap:A},r==null?void 0:r.id))})]})]})]})}),x&&e.jsx(U,{contact:x,onClose:()=>j(null)}),e.jsx(D,{})]})};export{se as default};
