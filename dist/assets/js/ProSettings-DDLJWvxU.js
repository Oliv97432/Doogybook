import{u as E,s as i,j as e}from"./index-DErj2e1l.js";import{d as A,r as n}from"./vendor-react-DEK6ZklB.js";import{U as P}from"./UserMenuPro-DniYuV4w.js";import{F as T}from"./Footer-xc1HNBWs.js";import{Y as D,o as h,B as j,M,N as R,j as X,ad as q,_ as F,e as v,F as I}from"./vendor-ui-DyJst9CI.js";import"./vendor-supabase-DfwcnzK-.js";const Y=()=>{var g,f;const{user:t,signOut:N}=E(),l=A(),[s,a]=n.useState({organization_name:"",organization_type:"",email:"",phone:"",address:"",city:"",postal_code:"",website:"",description:""}),[m,u]=n.useState(!1),[y,d]=n.useState(!1),[w,x]=n.useState(!1),[c,p]=n.useState(""),[z,_]=n.useState(!0);n.useEffect(()=>{t&&k()},[t]);const k=async()=>{try{const{data:r,error:o}=await i.from("professional_accounts").select("*").eq("user_id",t.id).single();if(o){console.error("Erreur chargement compte pro:",o),l("/settings");return}a({organization_name:r.organization_name||"",organization_type:r.organization_type||"",email:r.email||"",phone:r.phone||"",address:r.address||"",city:r.city||"",postal_code:r.postal_code||"",website:r.website||"",description:r.description||""})}catch(r){console.error("Erreur:",r)}finally{_(!1)}},C=async r=>{r.preventDefault(),u(!0),d(!1);try{const{error:o}=await i.from("professional_accounts").update({organization_name:s.organization_name,organization_type:s.organization_type,email:s.email,phone:s.phone,address:s.address,city:s.city,postal_code:s.postal_code,website:s.website,description:s.description,updated_at:new Date().toISOString()}).eq("user_id",t.id);if(o)throw o;d(!0),setTimeout(()=>d(!1),3e3)}catch(o){console.error("Erreur sauvegarde:",o),alert("❌ Erreur lors de la sauvegarde: "+o.message)}finally{u(!1)}},S=async()=>{if(c!==(t==null?void 0:t.email)){alert("❌ L'email ne correspond pas");return}if(window.confirm(`⚠️ ATTENTION : Cette action est irréversible !

En supprimant votre compte professionnel, vous perdrez :
- Tous vos chiens
- Toutes les candidatures
- Toutes les familles d'accueil
- Toutes vos données

Êtes-vous absolument certain de vouloir continuer ?`))try{const{error:o}=await i.from("dogs").delete().eq("professional_account_id",t.id);if(o)throw o;const{error:b}=await i.from("professional_accounts").delete().eq("user_id",t.id);if(b)throw b;await N(),l("/login"),alert("✅ Votre compte professionnel a été supprimé avec succès")}catch(o){console.error("Erreur suppression compte:",o),alert("❌ Erreur lors de la suppression du compte: "+o.message)}};return z?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Chargement..."})]})}):e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-card border-b border-border shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 sm:py-4 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>l("/pro/dashboard"),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-smooth py-2 min-h-[44px]",children:[e.jsx(D,{size:20}),e.jsx("span",{className:"text-base font-medium",children:"Retour"})]}),e.jsx(P,{})]})}),e.jsx("main",{className:"flex-1",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-heading font-bold text-foreground",children:"Paramètres du compte professionnel"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Gérez les informations de votre organisation"})]}),y&&e.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded-r-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{size:20,className:"text-green-500"}),e.jsx("p",{className:"text-green-900 font-medium",children:"Modifications enregistrées avec succès !"})]})}),e.jsx("div",{className:"bg-card rounded-xl border border-border p-6 shadow-soft",children:e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-primary to-primary/80 flex items-center justify-center text-white text-2xl font-bold flex-shrink-0",children:((f=(g=s.organization_name)==null?void 0:g.charAt(0))==null?void 0:f.toUpperCase())||"P"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-lg font-heading font-semibold text-foreground truncate",children:s.organization_name||"Nom de l'organisation"}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.email}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(h,{size:12,className:"text-green-500"}),e.jsx("span",{className:"text-xs text-green-600",children:"Compte vérifié"})]})]})]})}),e.jsxs("section",{className:"bg-card rounded-xl border border-border p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(j,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-heading font-semibold text-foreground",children:"Informations de l'organisation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nom, type, contact, adresse"})]})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Nom de l'organisation *"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),e.jsx("input",{type:"text",value:s.organization_name,onChange:r=>a({...s,organization_name:r.target.value}),className:"w-full pl-10 pr-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-foreground",placeholder:"Ex: Refuge Prospéo",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Type d'organisation"}),e.jsxs("select",{value:s.organization_type,onChange:r=>a({...s,organization_type:r.target.value}),className:"w-full px-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-foreground",children:[e.jsx("option",{value:"",children:"Sélectionnez un type"}),e.jsx("option",{value:"refuge",children:"Refuge"}),e.jsx("option",{value:"spa",children:"SPA"}),e.jsx("option",{value:"association",children:"Association"}),e.jsx("option",{value:"eleveur",children:"Éleveur"}),e.jsx("option",{value:"autre",children:"Autre"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Email de contact"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),e.jsx("input",{type:"email",value:s.email,onChange:r=>a({...s,email:r.target.value}),className:"w-full pl-10 pr-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-foreground",placeholder:"contact@refuge.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Téléphone"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),e.jsx("input",{type:"tel",value:s.phone,onChange:r=>a({...s,phone:r.target.value}),className:"w-full pl-10 pr-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-foreground",placeholder:"0262 XX XX XX"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Adresse"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-3 text-muted-foreground",size:18}),e.jsx("input",{type:"text",value:s.address,onChange:r=>a({...s,address:r.target.value}),className:"w-full pl-10 pr-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-foreground",placeholder:"123 Rue du Refuge"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Ville"}),e.jsx("input",{type:"text",value:s.city,onChange:r=>a({...s,city:r.target.value}),className:"w-full px-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-foreground",placeholder:"Saint-Denis"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Code postal"}),e.jsx("input",{type:"text",value:s.postal_code,onChange:r=>a({...s,postal_code:r.target.value}),className:"w-full px-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-foreground",placeholder:"97400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Site web"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),e.jsx("input",{type:"url",value:s.website,onChange:r=>a({...s,website:r.target.value}),className:"w-full pl-10 pr-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-foreground",placeholder:"https://www.refuge.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Description de l'organisation"}),e.jsx("textarea",{value:s.description,onChange:r=>a({...s,description:r.target.value}),rows:4,className:"w-full px-4 py-3 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background text-foreground resize-none",placeholder:"Présentez votre organisation et votre mission..."})]}),e.jsx("button",{type:"submit",disabled:m,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-smooth disabled:opacity-50 font-medium",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Enregistrement..."]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{size:20}),"Enregistrer les modifications"]})})]})]}),e.jsxs("section",{className:"bg-card rounded-xl border border-red-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0",children:e.jsx(v,{className:"text-red-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-heading font-semibold text-red-600",children:"Zone dangereuse"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Supprimer votre compte professionnel"})]})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsxs("p",{className:"text-sm text-red-800",children:[e.jsx("strong",{children:"⚠️ Attention :"})," La suppression de votre compte est définitive et irréversible. Toutes vos données (chiens, candidatures, familles d'accueil) seront perdues."]})}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-smooth",children:[e.jsx(I,{size:18}),"Supprimer mon compte professionnel"]})]})]})}),w&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0",children:e.jsx(v,{className:"text-red-600",size:24})}),e.jsx("h3",{className:"text-xl font-heading font-bold text-foreground",children:"Supprimer le compte"})]}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["Cette action est ",e.jsx("strong",{children:"irréversible"}),". Pour confirmer, veuillez saisir votre adresse email :"]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-sm text-amber-800",children:e.jsx("strong",{children:t==null?void 0:t.email})})}),e.jsx("input",{type:"email",value:c,onChange:r=>p(r.target.value),placeholder:"Confirmez votre email",className:"w-full px-4 py-3 border border-border rounded-lg mb-4 focus:ring-2 focus:ring-red-500 focus:border-transparent"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{x(!1),p("")},className:"flex-1 px-4 py-3 border border-border rounded-lg hover:bg-muted transition-smooth",children:"Annuler"}),e.jsx("button",{onClick:S,disabled:c!==(t==null?void 0:t.email),className:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-smooth",children:"Supprimer définitivement"})]})]})}),e.jsx(T,{})]})};export{Y as default};
